#! /usr/bin/env sh

source "${HOME}/.cache/wal/colors.sh"	# get colors
output="/dev/null"

echo -e ":: $(wal --preview) \n"

echo ":: Updating Discord"
pywal-discord > $output

echo ":: Updating Spotify / Spicetify"
spicetify update > $output

echo ":: Updating and restarting dunst"
$HOME/.config/dunst/launchdunst.sh

echo ":: Updating rofi"
cat $HOME/.config/wal/custom-templates/rofi-extras >> $HOME/.cache/wal/colors-rofi-dark.rasi
cat $HOME/.config/wal/custom-templates/rofi-extras >> $HOME/.cache/wal/colors-rofi-light.rasi

echo ":: Updating Telegram"
pushd $HOME/.cache/wal-telegram > $output
rm -f *.tdesktop-theme
rm -f *.png
${HOME}/programs/wal-telegram/wal-telegram > $output	 			# gen palette
convert -size 100x100 xc:${color0} "tiled.png" > $output 			# generate solid background
zip -j 	"colors.tdesktop-theme" "tiled.png" "colors.tdesktop-palette" > $output	# zip files into a theme
popd > $output

echo ":: Updating zathura"
pushd $HOME/.config/zathura > $output
echo "# zathurarc - generated by all-wal using zathurarc-defaults and wal/colors.sh" > zathurarc # clear contents
cat zathurarc-defaults | sed '1d' >> zathurarc
./wal-zathura >> zathurarc
popd > $output
